# API è‡ªåŠ¨åŒ–

feuse-mcp æä¾›å¼ºå¤§çš„ API è‡ªåŠ¨åŒ–åŠŸèƒ½ï¼Œèƒ½å¤Ÿç†è§£åç«¯æ¥å£æ–‡æ¡£å¹¶è‡ªåŠ¨ç”Ÿæˆå®Œæ•´çš„å‰ç«¯ API å·¥å…·é“¾ï¼Œæå¤§åœ°æå‡å¼€å‘æ•ˆç‡å¹¶ç¡®ä¿å‰åç«¯æ¥å£çš„ä¸€è‡´æ€§ã€‚

## å·¥å…·æ¦‚è¿°

### api-automation å·¥å…·

`api-automation` æ˜¯ä¸€ä¸ªä¸“é—¨çš„ä»£ç ç”ŸæˆåŠ©æ‰‹ï¼Œä¸“æ³¨äºåŸºäºåç«¯ API æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆå‰ç«¯ API ç›¸å…³ä»£ç ã€‚

#### **æ ¸å¿ƒèƒ½åŠ›**
- ğŸ“˜ **TypeScript æ¥å£ç±»å‹**ï¼šç²¾ç¡®çš„ç±»å‹å®šä¹‰ï¼Œç¡®ä¿ç±»å‹å®‰å…¨
- ğŸ”— **API URL å¸¸é‡**ï¼šç»Ÿä¸€çš„æ¥å£åœ°å€ç®¡ç†ï¼Œé¿å…ç¡¬ç¼–ç 
- ğŸ­ **Mock æ•°æ®**ï¼šç”¨äºå¼€å‘å’Œæµ‹è¯•çš„æ¨¡æ‹Ÿæ•°æ®ï¼Œæ”¯æŒç¦»çº¿å¼€å‘
- ğŸš€ **è¯·æ±‚å‡½æ•°**ï¼šå°è£…å¥½çš„ API è°ƒç”¨å‡½æ•°ï¼ŒåŒ…å«é”™è¯¯å¤„ç†

#### **æ”¯æŒçš„ API æ–‡æ¡£æ ¼å¼**
- OpenAPI/Swagger è§„èŒƒ
- Postman Collection
- Apifox æ–‡æ¡£
- è‡ªå®šä¹‰ JSON/YAML/MD æ ¼å¼
- çº¯æ–‡æœ¬ API è¯´æ˜

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬è°ƒç”¨

```
è¯·ä½¿ç”¨ api-automation å·¥å…·ï¼ŒåŸºäºä»¥ä¸‹ API æ–‡æ¡£ç”Ÿæˆä»£ç ï¼š

[ç²˜è´´å®Œæ•´çš„ API æ–‡æ¡£å†…å®¹æˆ–æä¾›æ–‡æ¡£é“¾æ¥]
```

### å‚æ•°è¯´æ˜

- `apiDocs` (å¿…éœ€): å®Œæ•´çš„åç«¯ API å®šä¹‰æ–‡æ¡£
- è‡ªåŠ¨æ£€æµ‹: å·¥å…·ä¼šè‡ªåŠ¨åˆ†æå½“å‰é¡¹ç›®çš„ç»“æ„å’Œä»£ç è§„èŒƒ

## ç”Ÿæˆçš„æ–‡ä»¶ç»“æ„

### é»˜è®¤ç›®å½•ç»“æ„

api-automation å·¥å…·ä¼šåœ¨é¡¹ç›®ä¸­ç”Ÿæˆä»¥ä¸‹ç»“æ„ï¼š

```
src/
â”œâ”€â”€ apis/              # API ç±»å‹å®šä¹‰å’Œ URL å¸¸é‡
â”‚   â””â”€â”€ getUserInfo.ts # ç”¨æˆ·ä¿¡æ¯æ¥å£
â”œâ”€â”€ mock/              # Mock æ•°æ®
â”‚   â””â”€â”€ getUserInfo.ts # ç”¨æˆ·ä¿¡æ¯æ¨¡æ‹Ÿæ•°æ®
â””â”€â”€ service/           # è¯·æ±‚æœåŠ¡å‡½æ•°
    â””â”€â”€ index.ts       # API è°ƒç”¨å‡½æ•°
```

### æ–‡ä»¶å‘½åè§„èŒƒ

- **æ–‡ä»¶å**: ä½¿ç”¨ API URL çš„æœ€åä¸€æ®µï¼Œè½¬æ¢ä¸º camelCase æ ¼å¼
  - `/api/user/get-user-info` â†’ `getUserInfo.ts`
- **å‡½æ•°å**: ä¸æ–‡ä»¶åä¿æŒä¸€è‡´çš„ camelCase æ ¼å¼
- **ç±»å‹å**: ä½¿ç”¨ PascalCase æ ¼å¼ï¼Œæ·»åŠ é€‚å½“çš„åç¼€
  - `GetUserInfoRequest`ã€`GetUserInfoResponse`


## ç”Ÿæˆä»£ç ç¤ºä¾‹

### API ç±»å‹å®šä¹‰æ–‡ä»¶

#### æ¥å£å®šä¹‰ä»¥åŠåœ°å€å¸¸é‡ï¼šæŸä¸ªé¡¹ç›®/src/apis
  - æ–‡ä»¶åä¸ºæ¥å£URLæœ€åä¸€éƒ¨åˆ†å¹¶ä¸”ç”¨å°é©¼å³°å‘½åï¼Œå¦‚ `queryOrderStatus.ts`
  - ä»£ç ç»“æ„å‚è€ƒå¦‚ä¸‹ï¼š
    ```ts
    // ç”¨æˆ·æŸ¥è¯¢è®¢å•çŠ¶æ€ç›¸å…³æ¥å£å®šä¹‰
    // path: /panzer_jack/api/v1/user/query_order_status
    // desc: ç”¨æˆ·ä¸‹å•

    export const QUERY_ORDER_STATUS = '/panzer_jack/api/v1/user/query_order_status'

    // è¯·æ±‚å‚æ•°æ¥å£
    export interface IQueryOrderStatusReq {
      order_id: string; // è®¢å•ID
    }

    // å“åº”æ•°æ®æ¥å£
    export interface IQueryOrderStatusResp {
      order_id: string; // è®¢å•ID
      status: string; // è®¢å•çŠ¶æ€
    }
    ```

#### mockæ•°æ®ï¼šæŸä¸ªé¡¹ç›®/src/mock
  - æ–‡ä»¶åä¸ºæ¥å£URLæœ€åä¸€éƒ¨åˆ†å¹¶ä¸”ç”¨å°é©¼å³°å‘½åï¼Œå¦‚ `queryOrderStatus.ts`
  - ä»£ç ç»“æ„å‚è€ƒå¦‚ä¸‹ï¼š
    ```ts
    // mock/queryOrderStatus.ts
    // path: /panzer_jack/api/v1/query_order_status
    // desc: ç”¨æˆ·æŸ¥è¯¢è®¢å•çŠ¶æ€

    import type { IQueryOrderStatusReq } from '@/apis/queryOrderStatus'
    import { QueryOrderStatusErrorCode } from '@/apis/queryOrderStatus'

    export default [
      {
        url: '/panzer_jack/api/v1/query_order_status',
        method: 'post',
        response: ({ body }: { body: IQueryOrderStatusReq }) => {
          console.log('æŸ¥è¯¢è®¢å•çŠ¶æ€è¯·æ±‚å‚æ•°:', body)

          // éªŒè¯å¿…è¦å‚æ•°
          if (!body.order_id) {
            return {
              code: 400,
              message: 'ç¼ºå°‘å¿…è¦å‚æ•° order_id',
              data: body
            }
          }

          // æ¨¡æ‹Ÿéšæœºç³»ç»Ÿé”™è¯¯çš„æƒ…å†µ (5%æ¦‚ç‡)
          if (Math.random() < 0.05) {
            return {
              code: QueryOrderStatusErrorCode.SYSTEM_ERROR,
              message: 'å‘ç”ŸæœªçŸ¥é”™è¯¯ï¼Œè¯·å‰å¾€è®¢å•åˆ—è¡¨ç¡®è®¤æ˜¯å¦ä¸‹å•æˆåŠŸæˆ–è¿›è¡Œå–æ¶ˆæ“ä½œï¼ˆè®¢å•åˆ—è¡¨å±•ç¤ºå¯èƒ½æœ‰15åˆ†é’Ÿå»¶è¿Ÿï¼‰',
              data: {}
            }
          }

          // æ¨¡æ‹Ÿä¸åŒçš„è®¢å•çŠ¶æ€
          const statusArray = ['pending', 'processing', 'completed', 'cancelled']
          const randomStatus = statusArray[Math.floor(Math.random() * statusArray.length)]

          // æ­£å¸¸æƒ…å†µï¼Œè¿”å›è®¢å•çŠ¶æ€
          return {
            code: 0,
            message: 'æŸ¥è¯¢è®¢å•çŠ¶æ€æˆåŠŸ',
            data: {
              order_id: body.order_id,
              status: randomStatus
            }
          }
        }
      }
    ]
    ```

#### é€šä¿¡å‡½æ•°ï¼šæŸä¸ªé¡¹ç›®/src/service/index.ts
  - å‡½æ•°åä¸ºæ¥å£URLæœ€åä¸€éƒ¨åˆ†å¹¶ä¸”ç”¨å°é©¼å³°å‘½åï¼Œå¦‚ `queryOrderStatus.ts`
  - ä»£ç ç»“æ„å‚è€ƒå¦‚ä¸‹ï¼š
  ```ts
  import { QUERY_ORDER_STATUS, type IQueryOrderStatusResp, type IQueryOrderStatusReq } from '@/apis/queryOrderStatus.ts'
  // ä½¿ç”¨å½“å‰é¡¹ç›®å·²æœ‰çš„è¯·æ±‚åº“å’Œå·²æœ‰çš„è¯·æ±‚å‡½æ•°è§„èŒƒå»ç”Ÿæˆè¯·æ±‚å‡½æ•°
  ```


## æ™ºèƒ½ç‰¹æ€§

### é¡¹ç›®ç»“æ„è‡ªé€‚åº”

å·¥å…·ä¼šè‡ªåŠ¨æ£€æµ‹é¡¹ç›®çš„ç°æœ‰ç»“æ„å’Œè§„èŒƒï¼š

- **è‡ªåŠ¨æ£€æµ‹ API ç›®å½•**: å¦‚æœé¡¹ç›®ä¸­å·²æœ‰ `src/api`ã€`src/apis` æˆ–å…¶ä»– API ç›¸å…³ç›®å½•
- **éµå¾ªç°æœ‰å‘½å**: åˆ†æç°æœ‰æ–‡ä»¶çš„å‘½åæ¨¡å¼å¹¶ä¿æŒä¸€è‡´
- **é€‚é…ä»£ç é£æ ¼**: æ ¹æ®é¡¹ç›®çš„ ESLintã€Prettier é…ç½®ç”Ÿæˆç¬¦åˆè§„èŒƒçš„ä»£ç 
- **æ¡†æ¶é€‚é…**: è‡ªåŠ¨è¯†åˆ« Reactã€Vueã€Angular ç­‰æ¡†æ¶å¹¶ç”Ÿæˆå¯¹åº”çš„ä»£ç é£æ ¼

### ä»£ç è§„èŒƒéµå¾ª

ç”Ÿæˆçš„ä»£ç ä¸¥æ ¼éµå¾ªä»¥ä¸‹è§„èŒƒï¼š

- **TypeScript ç±»å‹å®‰å…¨**: æ‰€æœ‰æ¥å£éƒ½æœ‰å®Œæ•´çš„ç±»å‹å®šä¹‰
- **é”™è¯¯å¤„ç†**: åŒ…å«å®Œå–„çš„é”™è¯¯å¤„ç†é€»è¾‘
- **ä»£ç æ³¨é‡Š**: è‡ªåŠ¨ç”Ÿæˆ JSDoc æ³¨é‡Š
- **å‘½åè§„èŒƒ**: éµå¾ªé¡¹ç›®çš„å‘½åçº¦å®š
- **ä»£ç æ ¼å¼**: ç¬¦åˆé¡¹ç›®çš„æ ¼å¼åŒ–è§„åˆ™

## æœ€ä½³å®è·µ

### 1. æ–‡æ¡£è´¨é‡
- ç¡®ä¿ API æ–‡æ¡£å®Œæ•´ä¸”å‡†ç¡®
- æä¾›è¯¦ç»†çš„è¯·æ±‚/å“åº”ç¤ºä¾‹
- ä½¿ç”¨æ¸…æ™°çš„å‘½åçº¦å®š

### 2. ä»£ç ç»´æŠ¤
- å®šæœŸé‡æ–°ç”Ÿæˆä»¥ä¿æŒåŒæ­¥
- è‡ªå®šä¹‰ä»£ç ä¸ç”Ÿæˆä»£ç åˆ†ç¦»
- ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶è¿½è¸ªå˜æ›´

### 3. é”™è¯¯å¤„ç†
- å®ç°ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶
- æ·»åŠ è¯·æ±‚æ‹¦æˆªå™¨å’Œå“åº”æ‹¦æˆªå™¨
- æä¾›åˆé€‚çš„åŠ è½½å’Œé”™è¯¯çŠ¶æ€

### 4. ç±»å‹å®‰å…¨
- å¯ç”¨ TypeScript ä¸¥æ ¼æ¨¡å¼
- ä½¿ç”¨ç”Ÿæˆçš„ç±»å‹å®šä¹‰
- é¿å…ä½¿ç”¨ `any` ç±»å‹